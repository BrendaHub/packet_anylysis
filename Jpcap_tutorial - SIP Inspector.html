<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0057)http://www.sipinspector.com/download/jpcap/JPcap_tutorial -->
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage" version="g42dymwpi--nx" style="height: auto;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<script type="text/javascript" charset="UTF-8" src="./Jpcap_tutorial - SIP Inspector_files/logb01.js"></script><script async="" src="./Jpcap_tutorial - SIP Inspector_files/analytics.js"></script><script type="text/javascript">/* Copyright 2008 Google. */ (function() { var b=window,e="chrome",g="tick",h="wtsrt_",l="tbsd_",m="tbnd_",n="start",p="_wtsrt",q="_tbnd",r="CSI/";(function(){function k(a){this.t={};this.tick=function(a,d,c){this.t[a]=[void 0!=c?c:(new Date).getTime(),d];if(void 0==c)try{b.console.timeStamp(r+a)}catch(f){}};this[g](n,null,a)}var a;b.performance&&(a=b.performance.timing);var s=a?new k(a.responseStart):new k;b.jstiming={Timer:k,load:s};if(a){var d=a.navigationStart,f=a.responseStart;0<d&&f>=d&&(b.jstiming.srt=f-d)}if(a){var c=b.jstiming.load;0<d&&f>=d&&(c[g](p,void 0,d),c[g](h,p,f),c[g](l,h))}try{a=null,b[e]&&b[e].csi&&(a=Math.floor(b[e].csi().pageT),
c&&0<d&&(c[g](q,void 0,b[e].csi().startE),c[g](m,q,d))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,c&&0<d&&(c[g](q,void 0,b.external.startE),c[g](m,q,d))),a&&(b.jstiming.pt=a)}catch(t){}})(); })()
</script>
<link rel="shortcut icon" href="http://www.sipinspector.com/_/rsrc/1298062174596/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/f8a050/system/app/images/apple-touch-icon.png" type="image/png">
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d=window,e="length",h="",k="__duration__",l="function";function m(c){return document.getElementById(c)}d.byId=m;function n(c){return c.replace(/^\s+|\s+$/g,h)}d.trim=n;var p=[],q=0;d.JOT_addListener=function(c,a,b){var f=new String(q++);c={eventName:c,handler:a,compId:b,key:f};p.push(c);return f};d.JOT_removeListenerByKey=function(c){for(var a=0;a<p[e];a++)if(p[a].key==c){p.splice(a,1);break}};d.JOT_removeAllListenersForName=function(c){for(var a=0;a<p[e];a++)p[a].eventName==c&&p.splice(a,1)};
d.JOT_postEvent=function(c,a,b){var f={eventName:c,eventSrc:a||{},payload:b||{}};if(d.JOT_fullyLoaded)for(a=p[e],b=0;b<a&&b<p[e];b++){var g=p[b];g&&g.eventName==c&&(f.listenerCompId=g.compId||h,(g=typeof g.handler==l?g.handler:d[g.handler])&&g(f))}else d.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};d.JOT_delayedEvents=[];d.JOT_fullyLoaded=!1;
d.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var f=0;60<=b&&(b/=60,f=2);2<=b&&f++;return a?d.JOT_siteRelTimeStrs[f].replace(k,Math.floor(b)):d.JOT_userRelTimeStrs[f].replace(k,Math.floor(b))}; })()
</script>
<script>


var webspace = {"scottyUrl":"/_/upload","isConsumer":true,"canPublishScriptToAnyone":true,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"sharingUrlPrefix":"/_/sharing","csiReportUri":"http://csi.gstatic.com/csi","sharingPolicy":"OPENED","siteNoticeUrlEnabled":null,"siteNoticeUrlAddress":null,"analyticsAccountId":"UA-6333052-1","baseUri":"","enableUniversalAnalytics":false,"name":"sipinspectorsite","features":{"tabInEditorBubble":true,"copySiteProgressUpdates":true,"asyncPermanentDelete":true,"colorsAndFontsFix":true,"docosHideNotificationSettings":true,"siteNoticeUrl":true,"asyncPageKeyFix":true,"pdfEmbedSupport":false,"siteMapBottomPaginationButtonsFix":true,"plusBadge":false,"hangoutEmbed":true,"analyticsTrackingForCorp":false,"freebirdFormEmbedDocTypeFix":true,"webspaceUrlScrubOnlyOnBlur":true,"addShortcutToTextBoxDialog":true,"htmlEmbed":true,"removeOnepickExtraCloseButton":true,"newCountDownDialog":true,"pageTreeKeyboardFix":true},"domain":"defaultdomain","adsensePublisherId":null,"gvizVersion":1,"siteTitle":"SIP Inspector","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttp://sites.google.com/site/sipinspectorsite/download/jpcap/JPcap_tutorial\u0026service\u003djotspot","pageSharingId":"jotspot_page","plusPageId":"","onepickBaseUrl":"https://docs.google.com","siteNoticeRevision":null,"termsUrl":"http://sites.google.com/site/sites/system/app/pages/meta/terms","enableAnalytics":true,"isPublic":true,"siteNoticeMessage":null,"plusPageUrl":"","homePath":"/","sharingId":"jotspot","isAdsenseEnabled":true,"adsensePromoClickedOrSiteIneligible":true,"isStartPageEnabled":false,"domainAnalyticsAccountId":""};



webspace.gadgets = {"baseUri":"/system/app/pages/gadgets"};


webspace.user = {"uid":"","renderMobile":false,"namespaceUser":false,"sessionIndex":"","primaryEmail":"guest","displayNameOrEmail":"guest","namespace":"","hasAdminAccess":false,"guest_":true,"keyboardShortcuts":true,"hasWriteAccess":false,"domain":"","dasherUser":false,"userName":"guest"};

webspace.page = {"canDeleteWebspace":null,"locale":"zh_CN","state":"","wuid":"wuid:gx:4c8c7116b4f48039","pageInheritsPermissions":null,"timeZone":"America/Los_Angeles","properties":{},"type":"text","canChangePath":true,"parentWuid":"wuid:gx:12580731a9ce6532","revision":3,"title":"Jpcap_tutorial","isRtlLocale":false,"bidiEnabled":false,"siteLocale":"en","name":"JPcap_tutorial","path":"/download/jpcap/JPcap_tutorial","isSiteRtlLocale":false,"parentPath":"/download/jpcap"};
webspace.page.breadcrumbs = [{"title":"Download","dir":"ltr","path":"/download","deleted":false},{"title":"JPcap","dir":"ltr","path":"/download/jpcap","deleted":false},{"title":"Jpcap_tutorial","dir":"ltr","path":"/download/jpcap/JPcap_tutorial","deleted":false}];


webspace.editorResources = {
  text: [
    'http://www.gstatic.com/sites/p/f8a050/system/js/codemirror.js',
    'http://www.gstatic.com/sites/p/f8a050/system/app/css/codemirror_css.css',
    'http://www.gstatic.com/sites/p/f8a050/system/js/trog_edit__zh_cn.js',
    'http://www.gstatic.com/sites/p/f8a050/system/app/css/trogedit.css',
    '/_/rsrc/1413376144000/system/app/css/editor.css',
    'http://www.gstatic.com/sites/p/f8a050/system/app/css/codeeditor.css',
    '/_/rsrc/1413376144000/system/app/css/camelot/editor-jfk.css'
  ],
  sitelayout: [
    'http://www.gstatic.com/sites/p/f8a050/system/app/css/sitelayouteditor.css'
  ]
};

var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/f8a050/system/app/images/cleardot.gif';


var JOT_userRelTimeStrs = ["1 \u5206\u949f\u524d","__duration__ \u5206\u949f\u4e4b\u524d","1 \u5c0f\u65f6\u524d","__duration__ \u5c0f\u65f6\u524d"];


webspace.siteTemplateId = false;


webspace.page.currentTemplate = {"title":"\u7f51\u9875","path":"/system/app/pagetemplates/text"};



var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<link rel="canonical" href="./Jpcap_tutorial - SIP Inspector_files/Jpcap_tutorial - SIP Inspector.html">
<meta name="title" content="Jpcap_tutorial - SIP Inspector">
<meta itemprop="name" content="Jpcap_tutorial - SIP Inspector">
<meta property="og:title" content="Jpcap_tutorial - SIP Inspector">
<meta name="description" content="SIP Inspector Pro - The best tool to create custom SIP scenarios">
<meta itemprop="description" content="SIP Inspector Pro - The best tool to create custom SIP scenarios">
<meta id="meta-tag-description" property="og:description" content="SIP Inspector Pro - The best tool to create custom SIP scenarios">
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="./Jpcap_tutorial - SIP Inspector_files/standard-css-default-ltr-ltr.css">
<link rel="stylesheet" type="text/css" href="./Jpcap_tutorial - SIP Inspector_files/overlay.css">
<link rel="stylesheet" type="text/css" href="./Jpcap_tutorial - SIP Inspector_files/allthemes-view.css">
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Jpcap_tutorial - SIP Inspector</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
<script></script><style>#haloword-pron { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -94px -34px; }#haloword-pron:hover { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -111px -34px; }#haloword-open { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -94px -17px; }#haloword-open:hover { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -111px -17px; }#haloword-close { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -94px 0; }#haloword-close:hover { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -111px 0; }#haloword-add { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -94px -51px; }#haloword-add:hover { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -111px -51px; }#haloword-remove { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -94px -68px; }#haloword-remove:hover { background: url(chrome-extension://bhkcehpnnlgncpnefpanachijmhikocj/img/icon.svg) -111px -68px; }</style><script src="./Jpcap_tutorial - SIP Inspector_files/ga.js"></script><script src="./Jpcap_tutorial - SIP Inspector_files/element.js"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Jpcap_tutorial - SIP Inspector_files/translateelement.css"><script type="text/javascript" charset="UTF-8" src="./Jpcap_tutorial - SIP Inspector_files/main_zh-CN.js"></script><script type="text/javascript" charset="UTF-8" src="./Jpcap_tutorial - SIP Inspector_files/element_main.js"></script><style>.goog-te-ftab-float {z-index:9999999; overflow:visible; position:fixed; _position:absolute;top:auto;left:auto;bottom:0px; _top:expression((-0-document.getElementById(':0.floatContainer').offsetHeight+(hack3=document.documentElement.clientHeight||document.body.clientHeight)+(hack4=document.documentElement.scrollTop||document.body.scrollTop))+'px');right:20px; _left:expression((-20-document.getElementById(':0.floatContainer').offsetWidth+(hack5=document.documentElement.clientWidth||document.body.clientWidth)+(hack6=document.documentElement.scrollLeft||document.body.scrollLeft))+'px');}</style></head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            " style="position: relative; min-height: 100%; top: 0px;">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tbody><tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="sites-chrome-header-valign-top" style="height: 80px"><div class="sites-header-cell-buffer-wrapper"><h2><a href="http://www.sipinspector.com/" dir="ltr" id="sites-chrome-userheader-title">SIP Inspector</a></h2></div></td><td class="sites-layout-searchbox sites-chrome-header-valign-top"></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</tbody></table> 
</div> 
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tbody><tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Navigation</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotid="navList" class="has-expander"><li class="topLevel nav-first "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/Home" jotid="wuid:gx:5db1f451fda6ec52" class="sites-navigation-link topLevel">SIP Inspector Pro</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/usecases" jotid="wuid:gx:159d12fd5ea09417" class="sites-navigation-link topLevel">Use Cases</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/screenshots" jotid="wuid:gx:7eb60667a0447136" class="sites-navigation-link topLevel">Screenshots</a></div></li><li class="topLevel parent " wuid="gx:385f7b87dd15a0d7"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="http://www.sipinspector.com/video-tutorials" jotid="wuid:gx:385f7b87dd15a0d7" class="sites-navigation-link topLevel">Video tutorials</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="http://www.sipinspector.com/video-tutorials/latestReview" jotid="wuid:gx:f53bb01649af78d" class="sites-navigation-link">3.10+ review</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="http://www.sipinspector.com/video-tutorials/registration" jotid="wuid:gx:2b18cfbe741d3bda" class="sites-navigation-link">Registration</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="http://www.sipinspector.com/video-tutorials/outgoing-call" jotid="wuid:gx:17496efb546f8a5f" class="sites-navigation-link">Outgoing call</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="http://www.sipinspector.com/video-tutorials/two-dialogs" jotid="wuid:gx:1b286131c38bd7c2" class="sites-navigation-link">Two dialogs</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/tutorial" jotid="wuid:gx:2a7371d10542894b" class="sites-navigation-link topLevel">Tutorial</a></div></li><li class="topLevel parent " wuid="gx:738f88a02c3ced43"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="http://www.sipinspector.com/download" jotid="wuid:gx:738f88a02c3ced43" class="sites-navigation-link topLevel">Download</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="https://sites.google.com/site/sipinspectorsite/download" class="sites-navigation-link">Binaries</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="http://www.sipinspector.com/download/jpcap" jotid="wuid:gx:12580731a9ce6532" class="sites-navigation-link">JPcap</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/purchase" jotid="wuid:gx:24973f6c567af01c" class="sites-navigation-link topLevel">Purchase</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/tools" jotid="wuid:gx:fd07f115078b5a6" class="sites-navigation-link topLevel">Tools</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/discussion" jotid="wuid:gx:7169206967091f7" class="sites-navigation-link topLevel">Discussion</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="http://www.sipinspector.com/contact" jotid="wuid:gx:7f1f6216523aea6" class="sites-navigation-link topLevel">Contact</a></div></li></ul></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="display: none;">
<a dir="ltr" href="http://www.sipinspector.com/download">Download</a>‎ &gt; ‎<a dir="ltr" href="http://www.sipinspector.com/download/jpcap">JPcap</a>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="display: none;" align="left">
<span id="sites-page-title" dir="ltr">Jpcap_tutorial</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><h1 style="font-family:Arial,Helvetica,sans-serif;line-height:48px;text-align:center"><a name="TOC-Jpcap-Tutorial"></a>Jpcap Tutorial</h1><span style="font-family:Arial,Helvetica,sans-serif;font-size:medium;line-height:24px;text-align:center">1.0 (for Jpcap 0.7)</span><br style="font-family:Arial,Helvetica,sans-serif;line-height:24px;font-size:medium;text-align:center"><br style="font-family:Arial,Helvetica,sans-serif;line-height:24px;font-size:medium;text-align:center"><div style="font-family:Arial,Helvetica,sans-serif;line-height:24px;font-size:medium">Author:<br>&nbsp;&nbsp;&nbsp; Keita Fujii (kfujii@uci.edu)<br>Home page:<br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://netresearch.ics.uci.edu/kfujii/jpcap/doc/index.html">http://netresearch.ics.uci.edu/kfujii/jpcap/doc/index.html</a><br><hr style="width:1202px;height:2px"><span style="font-weight:bold"><a name="toc"></a><big style="line-height:28px">Table of Contents</big></span><br><ul><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#intro">Introduction</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#tutorial">Jpcap tutorial: a step by step guide for using Jpcap</a></li><ul><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#obtain">Obtain the&nbsp;list of network interfaces</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#open">Open a network interface</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#capture">Capture packets from the network interface</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#set">Set capturing filter</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#save">Save captured packets into a file</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#read">Read saved packets from a file</a></li><li><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#send">Send packets through a network interface</a></li></ul></ul><hr style="width:1202px;height:2px"><h2 style="line-height:36px"><a name="intro"></a>Introduction</h2>This document describes how to develop applications using Jpcap. It explains the functions and classes defined in Jpcap, and also provides&nbsp;comprehensive descriptions on how to program using Jpcap by showing some example codes.<br><br>The latest version of this document can be found at:&nbsp;<a href="http://netresearch.ics.uci.edu/kfujii/jpcap/doc/tutorial/index.html">http://netresearch.ics.uci.edu/kfujii/jpcap/doc/tutorial/index.html</a><br><br><h3 style="line-height:28px"><a name="TOC-What-is-Jpcap"></a>What is Jpcap</h3>Jpcap is an open source library for capturing and sending network packets from Java applications. It provides facilities to:<br><ul><li>capture raw packets live from the wire.&nbsp;</li><li>save captured packets to an offline file, and read&nbsp;captured packets from an offline file.</li><li>automatically identify packet types and generate corresponding Java objects (for Ethernet, IPv4, IPv6, ARP/RARP, TCP, UDP, and ICMPv4 packets).</li><li>filter the packets according to user-specified rules before dispatching them to the application.</li><li>send raw packets to the network</li></ul>Jpcap is based on&nbsp;<a href="http://www.tcpdump.org/" target="_blank">libpcap</a>/<a href="http://www.winpcap.org/" target="_blank">winpcap</a>, and is implemented in C and Java.<br><br>Jpcap has been tested on Microsoft Windows (98/2000/XP/Vista), Linux (Fedora, Ubuntu), Mac OS X (Darwin), FreeBSD, and Solaris.<br><h3 style="line-height:28px"><a name="TOC-What-kind-of-applications-can-be-developed-using-Jpcap"></a>What kind of applications can be developed using Jpcap</h3>Jpcap can be used to develop&nbsp;many kinds of network applications, including (but not limited to):<ul><li>network and protocol analyzers</li><li>network monitors</li><li>traffic loggers</li><li>traffic generators</li><li>user-level bridges and routers</li><li>network intrusion detection systems (NIDS)</li><li>network scanners</li><li>security tools</li></ul><h3 style="line-height:28px"><a name="TOC-What-Jpcap-cannot-do"></a>What Jpcap cannot do</h3>Jpcap captures and sends&nbsp;packets&nbsp;<i>independently</i>&nbsp;from the host protocols (e.g.,&nbsp;TCP/IP). This means that Jpcap does not (cannot) block, filter or manipulate the traffic generated by other programs on the same machine: it simply "sniffs" the packets that transit on the wire. Therefore, it does not provide the appropriate support for applications like traffic shapers, QoS schedulers and personal firewalls.<br><br><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><br></div><hr style="width:1202px;height:2px"><h2 style="line-height:36px"><a name="tutorial"></a>Jpcap tutorial: a step by step guide for using Jpcap</h2><h3 style="line-height:28px"><a name="obtain"></a>Obtain the&nbsp;list of network interfaces</h3>When you want to capture packets from a network, the first thing you have to do is to obtain the list of network interfases on your machine. To do so, Jpcap provides<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#getDeviceList()">JpcapCaptor.getDeviceList()</a>&nbsp;method. It returns an array of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/NetworkInterface.html">NetworkInterface</a>&nbsp;objects.<br><br>A&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/NetworkInterface.html">NetworkInterface</a>&nbsp;object contains some information about the corresponding network interface, such as its name, description, IP and MAC addresses, and datatlink name and description.<br><br>The following sample code obtains the list of network interfaces and prints out their information.<br><br><div><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">//Obtain the list of network interfaces<br style="font-family:Arial,Helvetica,sans-serif">NetworkInterface[] devices = JpcapCaptor.getDeviceList();<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//for each network interface<br style="font-family:Arial,Helvetica,sans-serif">for (int i = 0; i &lt; devices.length; i++) {<br style="font-family:Arial,Helvetica,sans-serif">  //print out its name and description<br style="font-family:Arial,Helvetica,sans-serif">  System.out.println(i+": "+devices[i].name + "(" + devices[i].description+")");<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">  //print out its datalink name and description<br style="font-family:Arial,Helvetica,sans-serif">  System.out.println(" datalink: "+devices[i].datalink_name + "(" + devices[i].datalink_description+")");<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">  //print out its MAC address<br style="font-family:Arial,Helvetica,sans-serif">  System.out.print(" MAC address:");<br style="font-family:Arial,Helvetica,sans-serif">  for (byte b : devices[i].mac_address)<br style="font-family:Arial,Helvetica,sans-serif">    System.out.print(Integer.toHexString(b&amp;0xff) + ":");<br style="font-family:Arial,Helvetica,sans-serif">  System.out.println();<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">  //print out its IP address, subnet mask and broadcast address<br style="font-family:Arial,Helvetica,sans-serif">  for (NetworkInterfaceAddress a : devices[i].addresses)<br style="font-family:Arial,Helvetica,sans-serif">    System.out.println(" address:"+a.address + " " + a.subnet + " "+ a.broadcast);<br style="font-family:Arial,Helvetica,sans-serif">}</pre><br>This sample code may show a result like the following (on windows):&nbsp;<br><pre style="font-family:monospace,fixed">0: \Device\NPF_{C3F5996D-FB82-4311-A205-25B7761897B9}(VMware Virtual Ethernet Adapter)<br style="font-family:Arial,Helvetica,sans-serif">&nbsp;&nbsp;&nbsp; data link:EN10MB(Ethernet)<br style="font-family:Arial,Helvetica,sans-serif">&nbsp;&nbsp;&nbsp; MAC address:0:50:56:c0:0:1:<br style="font-family:Arial,Helvetica,sans-serif">&nbsp;&nbsp;&nbsp; address:/fe80:0:0:0:3451:e274:322a:fd9f null null<br style="font-family:Arial,Helvetica,sans-serif">&nbsp;&nbsp;&nbsp; address:/172.16.160.1 /255.255.255.0 /255.255.255.255</pre>or the following (on Linux/UNIX):<br><pre style="font-family:monospace,fixed">0 : eth0(null)<br style="font-family:Arial,Helvetica,sans-serif">&nbsp; &nbsp; datalink: EN10MB(Ethernet)<br style="font-family:Arial,Helvetica,sans-serif">    MAC address:0:c:29:fb:6c:df:<br style="font-family:Arial,Helvetica,sans-serif">    address:/172.16.32.129 /255.255.255.0 / 172.16.32.255</pre><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><hr style="width:1202px;height:2px"></div><h3 style="line-height:28px"><a name="open"></a>Open a network interface</h3>Once you obtain the list of network interfaces and choose which network interface to captuer packets from, you can open the interface by using&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#openDevice(jpcap.NetworkInterface,%20int,%20boolean,%20int)">JpcapCaptor.openDevice()</a>method. The following piece of code illustrates how to open an network interface.<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">NetworkInterface[] devices = JpcapCaptor.getDeviceList();<br style="font-family:Arial,Helvetica,sans-serif">int index=...;  // set index of the interface that you want to open.<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//Open an interface with openDevice(NetworkInterface intrface, int snaplen, boolean promics, int to_ms)<br style="font-family:Arial,Helvetica,sans-serif">JpcapCaptor captor=JpcapCaptor.openDevice(device[index], 65535, false, 20);<br style="font-family:Arial,Helvetica,sans-serif"></pre><br>When calling the&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#openDevice(jpcap.NetworkInterface,%20int,%20boolean,%20int)">JpcapCaptor.openDevice()</a>&nbsp;method, you can specify the following parameters:<br>&nbsp;<table border="0" cellpadding="2" cellspacing="2" style="width:1202px"><tbody><tr><td style="width:235px"><span style="font-weight:bold">Name:</span></td><td><span style="font-weight:bold">Purpose</span></td></tr><tr><td><span style="font-style:italic">NetworkInterface intrface</span></td><td>Network interface that you want to open.</td></tr><tr><td><span style="font-style:italic">int snaplen</span></td><td>Max number of bytes to capture at once.</td></tr><tr><td><span style="font-style:italic">boolean promics</span></td><td>True if you want to open the interface in promiscuous mode, and otherwise&nbsp;false.<br><div style="margin-left:40px">In promiscuous mode, you can&nbsp;capture packets every packet from the wire, i.e., even if its source or destination MAC address is not same as the MAC address of the interface you are opening.<br>In non-promiscuous mode, you can only capture packets send and received by your host.</div></td></tr><tr><td><span style="font-style:italic">int to_ms</span></td><td>Set a capture timeout value in milliseconds.</td></tr></tbody></table><br><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#openDevice(jpcap.NetworkInterface,%20int,%20boolean,%20int)">JpcapCaptor.openDevice()</a>&nbsp;returns an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html">JpcapCaptor</a>. You can then call several methods of the&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html">JpcapCaptor</a>&nbsp;class to actually capture packets from the network interface.<br><br><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><hr style="width:1202px;height:2px"></div><h3 style="line-height:28px"><a name="capture"></a>Capture packets from the network interface</h3>Once you obtain an instance of of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html">JpcapCaptor</a>, you can capture packets from the interface.<br><br>There are two major approaches to capture packets using a&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html">JpcapCaptor</a>&nbsp;instance: using a callback method, and capturing packets one-by-one.<br><br><span style="font-style:italic;text-decoration:underline">Using a callback method</span><br><br>In this approach, you implement a callback method to process captured packets, and then pass the callback method to Jpcap so that Jpcap calls it back every time it captures a packet. Let's see how you can do this approach in detail.<br><br>First, you implement a callback method by defining a new class which implements the&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/PacketReceiver.html">PacketReceiver</a>&nbsp;interface. The&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/PacketReceiver.html">PacketReceiver</a>&nbsp;interface defines &nbsp;a&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/PacketReceiver.html#receivePacket(jpcap.packet.Packet)">receivePacket()</a>method, so you need to implement a&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/PacketReceiver.html#receivePacket(jpcap.packet.Packet)">receivePacket()</a>&nbsp;method in your class.<br><br>The following class implement a&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/PacketReceiver.html#receivePacket(jpcap.packet.Packet)">receivePacket()</a>&nbsp;method which simply prints out a captured packet.<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">class PacketPrinter implements PacketReceiver {<br style="font-family:Arial,Helvetica,sans-serif">  //this method is called every time Jpcap captures a packet<br style="font-family:Arial,Helvetica,sans-serif">  public void receivePacket(Packet packet) {<br style="font-family:Arial,Helvetica,sans-serif">    //just print out a captured packet<br style="font-family:Arial,Helvetica,sans-serif">    System.out.println(packet);<br style="font-family:Arial,Helvetica,sans-serif">  }<br style="font-family:Arial,Helvetica,sans-serif">}</pre><br>Then, you can call either&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#processPacket(int,%20jpcap.PacketReceiver)">JpcapCaptor.processPacket()</a>&nbsp;or&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#loopPacket(int,%20jpcap.PacketReceiver)">JpcapCaptor.loopPacket()</a>&nbsp;methods to start capturing using the callback method. When calling&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#processPacket(int,%20jpcap.PacketReceiver)">processPacket()</a>or&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#loopPacket(int,%20jpcap.PacketReceiver)">loopPacket()</a>&nbsp;method, you can also specify the number of packets to capture before the method returns. You can specify -1 to continue capturing packets infinitely.&nbsp;<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">JpcapCaptor captor=JpcapCaptor.openDevice(device[index], 65535, false, 20);<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//call processPacket() to let Jpcap call PacketPrinter.receivePacket() for every packet capture.<br style="font-family:Arial,Helvetica,sans-serif">captor.processPacket(10,new PacketPrinter());<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">captor.close();<br style="font-family:Arial,Helvetica,sans-serif"></pre><br>The two methods for callback,&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#processPacket(int,%20jpcap.PacketReceiver)">processPacket()</a>&nbsp;and&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#loopPacket(int,%20jpcap.PacketReceiver)">loopPacket()</a>, are very similar. Usually you might want to use&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#processPacket(int,%20jpcap.PacketReceiver)">processPacket()</a>&nbsp;because it supports timeout and non_blocking mode, while&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#loopPacket(int,%20jpcap.PacketReceiver)">loopPacket()</a>&nbsp;doesn't.<br><br><span style="font-style:italic;text-decoration:underline">Capturing packets one-by-one<br><br></span>Using a callback method is a little bit tricky because you don't know when the callback method is called by Jpcap. If you don't want to use a callback method, you can also capture packets using the&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#getPacket()">JpcapCaptor.getPacket()</a>&nbsp;method.<br><br><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#getPacket()">getPacket()</a>&nbsp;method simply returns a captured packet. You can (or have to) call&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#getPacket()">getPacket()</a>&nbsp;method multiple times to capture consecutive packets.<br><br>The following&nbsp;sample code&nbsp;also prints out captured packets.<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">JpcapCaptor captor=JpcapCaptor.openDevice(device[index], 65535, false, 20);<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">for(int i=0;i&lt;10;i++){<br style="font-family:Arial,Helvetica,sans-serif">  //capture a single packet and print it out<br style="font-family:Arial,Helvetica,sans-serif">  System.out.println(captor.getPacket());<br style="font-family:Arial,Helvetica,sans-serif">}<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">captor.close();<br style="font-family:Arial,Helvetica,sans-serif"></pre><br><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><hr style="width:1202px;height:2px"></div><h3 style="line-height:28px"><a name="set"></a>Set capturing filter</h3>In Jpcap, you can set a filter so that Jpcap doesn't capture unwanted packets. For example, if you only want to capture TCP/IPv4 packets, you can set a filter as following:<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">JpcapCaptor captor=JpcapCaptor.openDevice(device[index], 65535, false, 20);<br style="font-family:Arial,Helvetica,sans-serif">//set a filter to only capture TCP/IPv4 packets<br style="font-family:Arial,Helvetica,sans-serif">captor.setFilter("ip and tcp", true);</pre><br>The filter expression "ip and tcp" means to to "keep only the packets that are both IPv4 and TCP and deliver them to the application".&nbsp;<br><br>By properly setting a filter, you can reduce the number of packets to examine, and thus can improve the performance of your application.<br><br>You can check the following homepage for more details about filter expression.<br><br><a href="http://home.insight.rr.com/procana/">Designing Capture Filters for Ethereal/Wireshark</a><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><hr style="width:1202px;height:2px"></div><h3 style="line-height:28px"><a name="save"></a>Save captured packets into a file</h3>You can save captured packets into a binary file so that you can later retrieve them using Jpcap or other applications which supports reading a tcpdump format file.<br><br>To save captured packets, you first need to open a file by calling&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapWriter.html#openDumpFile(jpcap.JpcapCaptor,%20java.lang.String)">JpcapWriter.openDumpFile()</a>&nbsp;method with an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html">JpcapCaptor</a>&nbsp;which was used to capture packets, and a String filename.<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">JpcapCaptor captor=JpcapCaptor.openDevice(device[index], 65535, false, 20);<br style="font-family:Arial,Helvetica,sans-serif">//open a file to save captured packets<br style="font-family:Arial,Helvetica,sans-serif">JpcapWriter writer=JpcapWriter.openDumpFile(captor,"yourfilename");</pre><br>Once you obtained an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapWriter.html">JpcapWriter</a>&nbsp;through&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapWriter.html#openDumpFile(jpcap.JpcapCaptor,%20java.lang.String)">openDumpFile()</a>&nbsp;method, you can save captured packets using&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapWriter.html#writePacket(jpcap.packet.Packet)">JpcapWriter.writePacket()</a>&nbsp;method. After you saved all the packets you want to save, you&nbsp;need to call&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapWriter.html#close()">JpcapWriter.close()</a>&nbsp;method to close the opened file.<br><br>The following sample code, combined with the above code, captures and saves first 100 packets captured.<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">for(int i=0;i&lt;10;i++){<br style="font-family:Arial,Helvetica,sans-serif">  //capture a single packet<br style="font-family:Arial,Helvetica,sans-serif">  Packet packet=captor.getPacket();<br style="font-family:Arial,Helvetica,sans-serif">  //save it into the opened file<br style="font-family:Arial,Helvetica,sans-serif">  writer.writePacket(packet);<br style="font-family:Arial,Helvetica,sans-serif">}<br style="font-family:Arial,Helvetica,sans-serif">writer.close();</pre><br><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><hr style="width:1202px;height:2px"></div><h3 style="line-height:28px"><a name="read"></a>Read saved packets from a file</h3>In Jpcap, you can read the packets you saved using&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapWriter.html">JpcapWriter</a>&nbsp;by opening the file using&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#openFile(java.lang.String)">JpcapCaptor.openFile()</a>&nbsp;method. Similar to&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#openDevice(jpcap.NetworkInterface,%20int,%20boolean,%20int)">JpcapCaptor.openDevice()</a>&nbsp;method,<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#openFile(java.lang.String)">JpcapCaptor.openFile()</a>&nbsp;method also returns an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html">JpcapCaptor</a>&nbsp;class. So you can use the same ways described in&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#capture">Capture packets from the network interface</a>section to read packets from the file. For example, you can read and print out saved packets from a file as follows:<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">//open a file to read saved packets<br style="font-family:Arial,Helvetica,sans-serif">JpcapCaptor captor=JpcapCaptor.openFile("yourfilename");<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">while(true){<br style="font-family:Arial,Helvetica,sans-serif">  //read a packet from the opened file<br style="font-family:Arial,Helvetica,sans-serif">  Packet packet=captor.getPacket();<br style="font-family:Arial,Helvetica,sans-serif">  //if some error occurred or EOF has reached, break the loop<br style="font-family:Arial,Helvetica,sans-serif">  if(packet==null || packet==Packet.EOF) break;<br style="font-family:Arial,Helvetica,sans-serif">  //otherwise, print out the packet<br style="font-family:Arial,Helvetica,sans-serif">  System.out.println(packet);<br style="font-family:Arial,Helvetica,sans-serif">}<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">captor.close();</pre><br><div style="text-align:right"><a href="http://www.eden.rutgers.edu/~muscarim/jpcap/tutorial/index.html#toc">Back to Table of Contents</a><hr style="width:1202px;height:2px"></div><h3 style="line-height:28px"><a name="send"></a>Send packets through a network interface</h3>You can also send packets to the network using Jpcap. &nbsp;To send a packet, you need to obtain an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapSender.html">JpcapSender</a>&nbsp;by calling either&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapSender.html#openDevice(jpcap.NetworkInterface)">JpcapSender.openDevice()</a>&nbsp;or<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapCaptor.html#getJpcapSenderInstance()">JpcapCaptor.getJpcapSenderInstance()</a>&nbsp;methods.<br><br>Once you obtain an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapSender.html">JpcapSender</a>, you can pass an instance of&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/packet/Packet.html">Packet</a>&nbsp;class to&nbsp;<a href="http://www.eden.rutgers.edu/~muscarim/jpcap/javadoc/jpcap/JpcapSender.html#sendPacket(jpcap.packet.Packet)">JpcapSender.sendPacket()</a>&nbsp;method.<br><br>The following sample code sends a TCP/IPv4/Ethernet packet onto a network interface.<br><br><pre style="font-family:monospace,fixed;border:1px solid rgb(204,204,204);margin:4px 8px 4px 2px;padding:4px 6px;background-color:rgb(245,245,245);overflow:auto">//open a network interface to send a packet to<br style="font-family:Arial,Helvetica,sans-serif">JpcapSender sender=JpcapSender.openDevice(devices[index]);<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//create a TCP packet with specified port numbers, flags, and other parameters<br style="font-family:Arial,Helvetica,sans-serif">TCPPacket p=new TCPPacket(12,34,56,78,false,false,false,false,true,true,true,true,10,10);<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//specify IPv4 header parameters<br style="font-family:Arial,Helvetica,sans-serif">p.setIPv4Parameter(0,false,false,false,0,false,false,false,0,1010101,100,IPPacket.IPPROTO_TCP,<br style="font-family:Arial,Helvetica,sans-serif">  InetAddress.getByName("www.microsoft.com"),InetAddress.getByName("www.google.com"));<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//set the data field of the packet<br style="font-family:Arial,Helvetica,sans-serif">p.data=("data").getBytes();<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//create an Ethernet packet (frame)<br style="font-family:Arial,Helvetica,sans-serif">EthernetPacket ether=new EthernetPacket();<br style="font-family:Arial,Helvetica,sans-serif">//set frame type as IP<br style="font-family:Arial,Helvetica,sans-serif">ether.frametype=EthernetPacket.ETHERTYPE_IP;<br style="font-family:Arial,Helvetica,sans-serif">//set source and destination MAC addresses<br style="font-family:Arial,Helvetica,sans-serif">ether.src_mac=new byte[]{(byte)0,(byte)1,(byte)2,(byte)3,(byte)4,(byte)5};<br style="font-family:Arial,Helvetica,sans-serif">ether.dst_mac=new byte[]{(byte)0,(byte)6,(byte)7,(byte)8,(byte)9,(byte)10};<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//set the datalink frame of the packet p as ether<br style="font-family:Arial,Helvetica,sans-serif">p.datalink=ether;<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">//send the packet p<br style="font-family:Arial,Helvetica,sans-serif">sender.sendPacket(p);<br style="font-family:Arial,Helvetica,sans-serif"><br style="font-family:Arial,Helvetica,sans-serif">sender.close();<br style="font-family:Arial,Helvetica,sans-serif"></pre></div><div><br></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div id="sites-attachments-container">
</div>
</div>
</div> 
</td> 
</tr>
</tbody></table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-subfooter"><div class="sites-subfooter-content"><br></div></div>
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="http://www.sipinspector.com/system/app/pages/reportAbuse" target="_blank">举报滥用行为</a><span aria-hidden="true">|</span><span class="sites-system-link">由</span> <b class="powered-by"><a href="http://sites.google.com/">Google 协作平台强力驱动</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>

<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="./Jpcap_tutorial - SIP Inspector_files/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
    
        sites.core.Analytics.createTracker();
        sites.core.Analytics.trackPageview();
      
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>

<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
        JOT_insertTranslateCode('zh_CN', 'en');
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
 //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupNoticeManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>


<div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Jpcap_tutorial - SIP Inspector_files/translate-32.png" width="20" height="20"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><div id="haloword-lookup" class="ui-widget-content ui-draggable"><div id="haloword-title"><span id="haloword-word"></span><a herf="#" id="haloword-pron" class="haloword-button" title="发音"></a><audio id="haloword-audio"></audio><div id="haloword-control-container"><a herf="#" id="haloword-add" class="haloword-button" title="加入单词表"></a><a herf="#" id="haloword-remove" class="haloword-button" title="移出单词表"></a><a href="http://www.sipinspector.com/download/jpcap/JPcap_tutorial#" id="haloword-open" class="haloword-button" title="查看单词详细释义" target="_blank"></a><a herf="#" id="haloword-close" class="haloword-button" title="关闭查询窗"></a></div><br style="clear: both;"></div><div id="haloword-content"></div></div><div id=":0.floatContainer" class=" goog-te-ftab-float" style="box-sizing: content-box; width: 60px; height: 24px;"><iframe id=":0.container" frameborder="0" src="javascript:''" class="goog-te-ftab-frame skiptranslate" style="visibility: visible; box-sizing: content-box; width: 60px; height: 24px;"></iframe></div></body></html>